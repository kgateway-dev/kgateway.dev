{{ $docsVersions := slice }}
{{ range site.Params.versions }}
    {{ $docsVersions = $docsVersions | append .linkVersion }}
{{ end }}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>404 - Page Not Found | kgateway</title>
  {{- partial "custom/head-end.html" . -}}
</head>

<script>
    var docsVersions = "{{ $docsVersions }}".slice(1, -1).split(' ');
    var pathname = window.location.pathname;
    var match = window.location.href.match(/.*\/docs\/([a-zA-Z0-9\.]+)\/?/);
    if (match) {
        var matchedPath = match[1];
        // Skip redirect for section names (envoy, agentgateway)
        if (matchedPath === "envoy" || matchedPath === "agentgateway") {
            // Let the section-specific redirects handle these
        } else if (matchedPath === "latest" && pathname.startsWith("/docs/latest/") && pathname.length > "/docs/latest/".length) {
            // /docs/latest/... (with more path) should go to /docs/envoy/latest/... (handles case when _redirects didn't fire)
            window.location.assign(window.location.origin + "/docs/envoy/latest/" + pathname.slice("/docs/latest/".length));
        } else if (docsVersions.includes(matchedPath)) {
            // /docs/{version} and /docs/{version}/ no longer exist; redirect to /docs/envoy/{version}
            if (pathname === "/docs/" + matchedPath || pathname === "/docs/" + matchedPath + "/") {
                var trailingSlash = pathname.endsWith("/") ? "/" : "";
                window.location.assign(window.location.origin + "/docs/envoy/" + matchedPath + trailingSlash);
            }
        } else {
            // match is not a valid docs version, insert `latest` after docs and retry
            window.location.assign(window.location.href.replace("/docs/", "/docs/latest/"));
        }
    }
</script>

<body
    style='font-family:system-ui,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji"; margin: 0; padding-top: 100px;'>
    {{- partial "nav.html" . -}}
    <div style="height: calc(100vh - 100px); text-align:center; display:flex; flex-direction:column; align-items:center; justify-content:center;">
    <div>
        <style>
            body {
                color: #000;
                background: #fff;
                margin: 0;
            }

            .next-error-h1 {
                border-right: 1px solid rgba(0, 0, 0, 0.3);
            }

            @media (prefers-color-scheme: dark) {
                body {
                    color: #fff;
                    background: #000;
                }

                .next-error-h1 {
                    border-right: 1px solid rgba(255, 255, 255, 0.3);
                }
            }
        </style>
        <h1 class="next-error-h1"
            style='display: inline-block; margin: 0 20px 0 0; padding-right: 23px; font-size: 24px; font-weight: 500; vertical-align: top; line-height: 49px; font-feature-settings: "rlig" 1,"calt" 1,"ss01" 1,"ss06" 1 !important;'>
            404</h1>
        <div style="display: inline-block; text-align: left">
            <h2 style="font-size: 14px; font-weight: 400; line-height: 49px; margin: 0">This page could not be found.
            </h2>
        </div>
    </div>
</body>
</html>
